<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PWA Setup & Testing - Primary School Learning App</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #4ECDC4;
            text-align: center;
            margin-bottom: 30px;
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }
        .section h2 {
            color: #333;
            margin-top: 0;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .btn {
            display: inline-block;
            padding: 10px 20px;
            background: #4ECDC4;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            margin: 5px;
            border: none;
            cursor: pointer;
            font-size: 14px;
        }
        .btn:hover {
            background: #45B7D1;
        }
        .btn.secondary {
            background: #6c757d;
        }
        .btn.secondary:hover {
            background: #5a6268;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .feature-card {
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            text-align: center;
        }
        .feature-card h3 {
            margin-top: 0;
            color: #4ECDC4;
        }
        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 12px;
        }
        .test-results {
            margin-top: 20px;
        }
        .test-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #e0e0e0;
        }
        .test-item:last-child {
            border-bottom: none;
        }
        .test-status {
            font-weight: bold;
        }
        .test-status.pass {
            color: #28a745;
        }
        .test-status.fail {
            color: #dc3545;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ PWA Setup & Testing</h1>
        <p>Welcome to the Primary School Learning App setup page. This page helps you verify that all PWA features are working correctly.</p>

        <div class="section">
            <h2>üìã Quick Start</h2>
            <div class="grid">
                <div class="feature-card">
                    <h3>üè† Main App</h3>
                    <p>Access the main learning application</p>
                    <a href="index.html" class="btn">Open App</a>
                </div>
                <div class="feature-card">
                    <h3>üìö Standard 1</h3>
                    <p>View Standard 1 content</p>
                    <a href="std1/std1.html" class="btn">View Standard 1</a>
                </div>
                <div class="feature-card">
                    <h3>üìñ Sample Lesson</h3>
                    <p>Test a sample lesson</p>
                    <a href="std1/tamil/index.html" class="btn">View Lesson</a>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>üîß PWA Status</h2>
            <div id="pwaStatus">
                <div class="status warning">Checking PWA status...</div>
            </div>
            <div class="test-results" id="testResults"></div>
        </div>

        <div class="section">
            <h2>üß™ Manual Testing</h2>
            <p>Use these buttons to test various PWA features:</p>
            
            <button class="btn" onclick="testServiceWorker()">Test Service Worker</button>
            <button class="btn" onclick="testOffline()">Test Offline Mode</button>
            <button class="btn" onclick="testLanguage()">Test Language Switch</button>
            <button class="btn" onclick="testStorage()">Test Local Storage</button>
            <button class="btn" onclick="clearCache()">Clear Cache</button>
            <button class="btn secondary" onclick="showDebugInfo()">Show Debug Info</button>
        </div>

        <div class="section">
            <h2>üì± Installation</h2>
            <p>To install this app on your device:</p>
            <ol>
                <li>Open the app in Chrome or Edge</li>
                <li>Look for the install button in the address bar</li>
                <li>Or use the browser menu: More Tools ‚Üí Create Shortcut</li>
                <li>On mobile, use "Add to Home Screen"</li>
            </ol>
            <div class="status success">
                <strong>Note:</strong> PWA installation requires HTTPS. For local development, use a local server with HTTPS or test on a hosted version.
            </div>
        </div>

        <div class="section">
            <h2>üåê Local Development</h2>
            <p>Start a local server using one of these commands:</p>
            <pre><code># Python 3
python -m http.server 8000

# Python 2
python -m SimpleHTTPServer 8000

# Node.js
npx http-server -p 8000

# PHP
php -S localhost:8000</code></pre>
            <p>Then open: <a href="http://localhost:8000" target="_blank">http://localhost:8000</a></p>
        </div>

        <div class="section">
            <h2>üìä Performance</h2>
            <p>Test the app's performance using Lighthouse:</p>
            <ol>
                <li>Open Chrome DevTools (F12)</li>
                <li>Go to the Lighthouse tab</li>
                <li>Select "Progressive Web App"</li>
                <li>Click "Generate report"</li>
            </ol>
            <div class="status warning">
                <strong>Target Score:</strong> 90+ for PWA, 90+ for Performance, 90+ for Accessibility
            </div>
        </div>

        <div class="section">
            <h2>üêõ Troubleshooting</h2>
            <div class="grid">
                <div class="feature-card">
                    <h3>App Not Working Offline</h3>
                    <ul style="text-align: left;">
                        <li>Check service worker registration</li>
                        <li>Verify HTTPS is enabled</li>
                        <li>Clear browser cache</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h3>PWA Not Installing</h3>
                    <ul style="text-align: left;">
                        <li>Ensure manifest.json is valid</li>
                        <li>Check HTTPS requirement</li>
                        <li>Verify icon files exist</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h3>Language Not Changing</h3>
                    <ul style="text-align: left;">
                        <li>Check translation files</li>
                        <li>Verify language codes</li>
                        <li>Clear localStorage</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // PWA Status Check
        async function checkPWAStatus() {
            const results = [];
            
            // Check Service Worker
            if ('serviceWorker' in navigator) {
                results.push({ test: 'Service Worker Support', status: 'pass' });
            } else {
                results.push({ test: 'Service Worker Support', status: 'fail' });
            }
            
            // Check Manifest
            if (document.querySelector('link[rel="manifest"]')) {
                results.push({ test: 'Web App Manifest', status: 'pass' });
            } else {
                results.push({ test: 'Web App Manifest', status: 'fail' });
            }
            
            // Check HTTPS
            if (location.protocol === 'https:' || location.hostname === 'localhost') {
                results.push({ test: 'HTTPS/Localhost', status: 'pass' });
            } else {
                results.push({ test: 'HTTPS/Localhost', status: 'fail' });
            }
            
            // Check IndexedDB
            if ('indexedDB' in window) {
                results.push({ test: 'IndexedDB Support', status: 'pass' });
            } else {
                results.push({ test: 'IndexedDB Support', status: 'fail' });
            }
            
            // Check Canvas
            if (document.createElement('canvas').getContext) {
                results.push({ test: 'Canvas Support', status: 'pass' });
            } else {
                results.push({ test: 'Canvas Support', status: 'fail' });
            }
            
            // Check Touch Support
            if ('ontouchstart' in window) {
                results.push({ test: 'Touch Support', status: 'pass' });
            } else {
                results.push({ test: 'Touch Support', status: 'fail' });
            }
            
            displayTestResults(results);
        }
        
        function displayTestResults(results) {
            const container = document.getElementById('testResults');
            const statusDiv = document.getElementById('pwaStatus');
            
            let allPassed = true;
            let html = '';
            
            results.forEach(result => {
                if (result.status === 'fail') allPassed = false;
                
                html += `
                    <div class="test-item">
                        <span>${result.test}</span>
                        <span class="test-status ${result.status}">${result.status.toUpperCase()}</span>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            
            if (allPassed) {
                statusDiv.innerHTML = '<div class="status success">‚úÖ All PWA features are supported!</div>';
            } else {
                statusDiv.innerHTML = '<div class="status error">‚ùå Some PWA features are not supported. Check the test results below.</div>';
            }
        }
        
        // Test Functions
        async function testServiceWorker() {
            try {
                if ('serviceWorker' in navigator) {
                    const registration = await navigator.serviceWorker.register('/service-worker.js');
                    alert('Service Worker registered successfully!');
                } else {
                    alert('Service Worker not supported in this browser.');
                }
            } catch (error) {
                alert('Service Worker registration failed: ' + error.message);
            }
        }
        
        function testOffline() {
            if (navigator.onLine) {
                alert('You are currently online. To test offline mode:\n1. Open DevTools (F12)\n2. Go to Application tab\n3. Check "Offline" checkbox\n4. Refresh the page');
            } else {
                alert('You are currently offline. The app should work without internet connection.');
            }
        }
        
        function testLanguage() {
            const currentLang = document.documentElement.lang;
            alert(`Current language: ${currentLang}\n\nTo test language switching, go to the main app and use the language switcher in the header.`);
        }
        
        function testStorage() {
            try {
                localStorage.setItem('test', 'PWA Test');
                const testValue = localStorage.getItem('test');
                localStorage.removeItem('test');
                alert('Local Storage is working correctly!');
            } catch (error) {
                alert('Local Storage test failed: ' + error.message);
            }
        }
        
        async function clearCache() {
            try {
                if ('caches' in window) {
                    const cacheNames = await caches.keys();
                    await Promise.all(cacheNames.map(name => caches.delete(name)));
                    alert('Cache cleared successfully!');
                } else {
                    alert('Cache API not supported.');
                }
            } catch (error) {
                alert('Failed to clear cache: ' + error.message);
            }
        }
        
        function showDebugInfo() {
            const info = {
                userAgent: navigator.userAgent,
                language: navigator.language,
                onLine: navigator.onLine,
                cookieEnabled: navigator.cookieEnabled,
                platform: navigator.platform,
                screenSize: `${screen.width}x${screen.height}`,
                windowSize: `${window.innerWidth}x${window.innerHeight}`,
                protocol: location.protocol,
                hostname: location.hostname,
                pathname: location.pathname
            };
            
            console.log('Debug Info:', info);
            alert('Debug information logged to console. Press F12 to view.');
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            checkPWAStatus();
        });
    </script>
</body>
</html> 