<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Interactive angles lesson for Standard 5 students with games and activities">
    <meta name="theme-color" content="#4ECDC4">
    <title>Learning About Angles - Interactive Lesson</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="../../../../manifest.json">
    
    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="../../../../assets/images/icons/icon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../../assets/images/icons/icon-16.png">
    <link rel="apple-touch-icon" href="../../../../assets/images/icons/icon-192.png">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="../../../../assets/css/main.css">
    <link rel="stylesheet" href="../../../../assets/css/animations.css">
    
    <!-- Fonts -->
    <link rel="preload" href="../../../../assets/fonts/NotoSans-Regular.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="../../../../assets/fonts/NotoSansTamil-Regular.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="../../../../assets/fonts/NotoNastaliqUrdu-Regular.woff2" as="font" type="font/woff2" crossorigin>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        .lesson-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
        }

        .header h1 {
            font-size: 2.5rem;
            color: #4F46E5;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            animation: bounce 2s ease-in-out infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: #e0e7ff;
            border-radius: 6px;
            overflow: hidden;
            margin: 20px 0;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #3b82f6, #8b5cf6);
            width: 0%;
            transition: width 0.8s ease;
            border-radius: 6px;
        }

        .lesson-section {
            background: rgba(255, 255, 255, 0.95);
            margin: 20px 0;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            display: none;
        }

        .lesson-section.active {
            display: block;
            animation: slideIn 0.6s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-title {
            font-size: 2.2rem;
            color: #4F46E5;
            margin-bottom: 25px;
            text-align: center;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }

        .interactive-angle {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 30px 0;
            position: relative;
        }

        .angle-canvas {
            border: 4px solid #4F46E5;
            border-radius: 15px;
            background: #f8fafc;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(79, 70, 229, 0.3);
        }

        .angle-canvas:hover {
            transform: scale(1.02);
            box-shadow: 0 8px 25px rgba(79, 70, 229, 0.4);
        }

        .angle-info {
            margin: 25px 0;
            padding: 25px;
            background: linear-gradient(135deg, #fef3c7, #fed7aa);
            border-radius: 15px;
            border-left: 6px solid #f59e0b;
            box-shadow: 0 4px 15px rgba(245, 158, 11, 0.2);
        }

        .angle-types {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin: 35px 0;
        }

        .angle-type-card {
            background: linear-gradient(135deg, #e0f2fe, #b3e5fc);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            border: 4px solid transparent;
            transition: all 0.4s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .angle-type-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .angle-type-card:hover::before {
            left: 100%;
        }

        .angle-type-card:hover {
            transform: translateY(-8px) scale(1.02);
            border-color: #0ea5e9;
            box-shadow: 0 20px 40px rgba(14, 165, 233, 0.3);
        }

        .angle-type-card.selected {
            background: linear-gradient(135deg, #dbeafe, #93c5fd);
            border-color: #3b82f6;
            transform: scale(1.08);
            box-shadow: 0 15px 35px rgba(59, 130, 246, 0.4);
        }

        .matching-game {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            padding: 30px;
            border-radius: 20px;
            margin: 30px 0;
            border: 3px solid #0ea5e9;
        }

        .matching-pairs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .match-item {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border: 3px solid #e5e7eb;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .match-item:hover {
            border-color: #3b82f6;
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.3);
        }

        .match-item.selected {
            border-color: #f59e0b;
            background: linear-gradient(135deg, #fef3c7, #fed7aa);
            transform: scale(1.08);
        }

        .match-item.correct {
            border-color: #10b981;
            background: linear-gradient(135deg, #d1fae5, #a7f3d0);
            animation: correctMatch 0.6s ease;
        }

        .match-item.incorrect {
            border-color: #ef4444;
            background: linear-gradient(135deg, #fee2e2, #fca5a5);
            animation: shake 0.5s ease;
        }

        @keyframes correctMatch {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1.1); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .naming-game {
            background: linear-gradient(135deg, #fef7ff, #f3e8ff);
            padding: 30px;
            border-radius: 20px;
            margin: 30px 0;
            border: 3px solid #8b5cf6;
        }

        .angle-diagram {
            position: relative;
            width: 300px;
            height: 200px;
            margin: 20px auto;
            background: white;
            border: 2px solid #8b5cf6;
            border-radius: 10px;
        }

        .drag-labels {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }

        .drag-label {
            background: linear-gradient(135deg, #ddd6fe, #c4b5fd);
            padding: 10px 20px;
            border-radius: 25px;
            cursor: grab;
            border: 2px solid #8b5cf6;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .drag-label:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(139, 92, 246, 0.3);
        }

        .drag-label.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }

        .drop-zone {
            position: absolute;
            width: 60px;
            height: 30px;
            border: 2px dashed #8b5cf6;
            border-radius: 5px;
            background: rgba(139, 92, 246, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: #8b5cf6;
        }

        .alphabet-game {
            background: linear-gradient(135deg, #ecfdf5, #d1fae5);
            padding: 30px;
            border-radius: 20px;
            margin: 30px 0;
            border: 3px solid #10b981;
        }

        .alphabet-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 15px;
            margin: 25px 0;
        }

        .alphabet-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border: 3px solid #10b981;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 2rem;
            font-weight: bold;
            color: #065f46;
        }

        .alphabet-card:hover {
            transform: rotate(5deg) scale(1.1);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.3);
        }

        .quiz-container {
            background: linear-gradient(135deg, #fef7ff, #f3e8ff);
            padding: 35px;
            border-radius: 20px;
            margin: 25px 0;
            border: 4px solid #8b5cf6;
        }

        .quiz-question {
            font-size: 1.4rem;
            color: #581c87;
            margin-bottom: 25px;
            text-align: center;
            font-weight: bold;
        }

        .quiz-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .quiz-option {
            padding: 20px 25px;
            background: #ffffff;
            border: 4px solid #e5e7eb;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.4s ease;
            text-align: center;
            font-weight: bold;
            font-size: 1.1rem;
            position: relative;
            overflow: hidden;
        }

        .quiz-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(139, 92, 246, 0.2), transparent);
            transition: left 0.3s;
        }

        .quiz-option:hover::before {
            left: 100%;
        }

        .quiz-option:hover {
            border-color: #8b5cf6;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(139, 92, 246, 0.3);
        }

        .quiz-option.correct {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border-color: #10b981;
            animation: pulse 0.6s ease;
        }

        .quiz-option.incorrect {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            border-color: #ef4444;
            animation: shake 0.5s ease;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 40px 0;
            padding: 0 20px;
        }

        .nav-btn {
            padding: 18px 35px;
            background: linear-gradient(135deg, #4F46E5, #7C3AED);
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 6px 20px rgba(79, 70, 229, 0.3);
            position: relative;
            overflow: hidden;
        }

        .nav-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .nav-btn:hover::before {
            left: 100%;
        }

        .nav-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(79, 70, 229, 0.4);
        }

        .nav-btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            padding: 50px;
            border-radius: 25px;
            text-align: center;
            z-index: 1000;
            display: none;
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.3);
            border: 4px solid #f59e0b;
        }

        .celebration.show {
            display: block;
            animation: celebrationBounce 0.8s ease-out;
        }

        @keyframes celebrationBounce {
            0% {
                transform: translate(-50%, -50%) scale(0.3);
                opacity: 0;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.1);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }

        .real-world-examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            margin: 35px 0;
        }

        .example-card {
            background: linear-gradient(135deg, #ecfdf5, #d1fae5);
            padding: 25px;
            border-radius: 18px;
            text-align: center;
            transition: all 0.4s ease;
            border: 3px solid #10b981;
            cursor: pointer;
        }

        .example-card:hover {
            transform: scale(1.08) rotate(2deg);
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
        }

        .example-icon {
            font-size: 3.5rem;
            margin-bottom: 15px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .game-score {
            background: linear-gradient(135deg, #fef3c7, #fed7aa);
            padding: 15px 25px;
            border-radius: 25px;
            text-align: center;
            margin: 20px 0;
            border: 3px solid #f59e0b;
            font-weight: bold;
            font-size: 1.2rem;
            color: #92400e;
        }

        .fun-fact {
            background: linear-gradient(135deg, #e0f2fe, #bae6fd);
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            border-left: 6px solid #0ea5e9;
            font-style: italic;
            font-size: 1.1rem;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }
            
            .lesson-container {
                padding: 15px;
            }
            
            .lesson-section {
                padding: 25px;
            }
            
            .angle-types, .matching-pairs, .alphabet-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-btn {
                padding: 15px 25px;
                font-size: 1rem;
            }
        }

        /* Template Integration Styles */
        .header {
            background: linear-gradient(135deg, #4ECDC4 0%, #45B7D1 100%);
            color: white;
            padding: 1rem 2rem;
            box-shadow: 0 4px 15px rgba(78, 205, 196, 0.3);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .menu-toggle {
            background: none;
            border: none;
            cursor: pointer;
            padding: 10px;
            flex-direction: column;
            gap: 4px;
            display: flex;
        }

        .menu-toggle span {
            width: 25px;
            height: 3px;
            background: white;
            border-radius: 2px;
            transition: 0.3s;
        }

        .school-name {
            font-size: 1.2rem;
            font-weight: 600;
            margin: 0;
        }

        .school-name-short {
            display: none;
        }

        @media (max-width: 768px) {
            .school-name-full { display: none; }
            .school-name-short { display: inline; }
        }

        .header-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .view-toggle, .language-switcher {
            display: flex;
            gap: 0.5rem;
        }

        .view-btn, .lang-btn {
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            transition: 0.3s;
        }

        .view-btn:hover, .lang-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .lang-btn.active {
            background: rgba(255, 255, 255, 0.4);
        }

        .sidebar {
            position: fixed;
            top: 0;
            left: -300px;
            width: 300px;
            height: 100vh;
            background: white;
            z-index: 1001;
            transition: left 0.3s ease;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
        }

        .sidebar.active {
            left: 0;
        }

        .sidebar-header {
            padding: 1rem;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .close-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px;
        }

        .nav-menu {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .nav-menu li {
            border-bottom: 1px solid #f0f0f0;
        }

        .nav-link {
            display: block;
            padding: 1rem;
            color: #333;
            text-decoration: none;
            transition: 0.3s;
        }

        .nav-link:hover {
            background: #f8f9fa;
            color: #4ECDC4;
        }

        .nav-link.active {
            background: #4ECDC4;
            color: white;
        }

        .nav-section-title {
            display: block;
            padding: 0.8rem 1rem;
            background: #f8f9fa;
            font-weight: 600;
            color: #666;
            font-size: 0.9rem;
            text-transform: uppercase;
        }

        .nav-submenu {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .nav-submenu .nav-link {
            padding-left: 2rem;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #4ECDC4;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header class="header">
        <button class="menu-toggle" id="menuToggle" aria-label="Toggle navigation menu">
            <span></span>
            <span></span>
            <span></span>
        </button>
        
        <h1 class="school-name" data-translate="messages.schoolName">
            <span class="school-name-full">Primary School Learning App</span>
            <span class="school-name-short">School App</span>
        </h1>
        
        <div class="header-controls">
            <div class="view-toggle">
                <button class="view-btn active" data-view="grid" aria-label="Grid view">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 3h7v7H3V3zm0 11h7v7H3v-7zm11-11h7v7h-7V3zm0 11h7v7h-7v-7z"/>
                    </svg>
                </button>
                <button class="view-btn" data-view="list" aria-label="List view">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/>
                    </svg>
                </button>
            </div>
            
            <div class="language-switcher">
                <button class="lang-btn active" data-lang="en">EN</button>
                <button class="lang-btn" data-lang="ta">தமிழ்</button>
                <button class="lang-btn" data-lang="ur">اردو</button>
            </div>
        </div>
    </header>

    <!-- Navigation Sidebar -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2 data-translate="navigation">Navigation</h2>
            <button class="close-btn" id="closeSidebar" aria-label="Close navigation">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                </svg>
            </button>
        </div>
        
        <ul class="nav-menu">
            <li><a href="../../../../index.html" class="nav-link" data-translate="home">Home</a></li>
            <li class="nav-section">
                <span class="nav-section-title" data-translate="allStandards">All Standards</span>
                <ul class="nav-submenu">
                    <li><a href="../../../../std1/std1.html" class="nav-link" data-translate="standards.standard1">1st STD</a></li>
                    <li><a href="../../../../std2/std2.html" class="nav-link" data-translate="standards.standard2">2nd STD</a></li>
                    <li><a href="../../../../std3/std3.html" class="nav-link" data-translate="standards.standard3">3rd STD</a></li>
                    <li><a href="../../../../std4/std4.html" class="nav-link" data-translate="standards.standard4">4th STD</a></li>
                    <li><a href="../../../../std5/std5.html" class="nav-link active" data-translate="standards.standard5">5th STD</a></li>
                    <li><a href="../../../../std6/std6.html" class="nav-link" data-translate="standards.standard6">6th STD</a></li>
                </ul>
            </li>
            <li><a href="../../../../settings.html" class="nav-link" data-translate="settings">Settings</a></li>
            <li><a href="../../../../about.html" class="nav-link" data-translate="about">About</a></li>
        </ul>
    </nav>

    <div class="lesson-container" style="margin-top: 80px;">
        <div class="header">
            <h1>🔺 Amazing World of Angles! 🔺</h1>
            <p>Let's explore angles together - they're everywhere around us!</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar"></div>
            </div>
            <div class="game-score" id="gameScore">🌟 Score: 0 points</div>
        </div>

        <!-- Section 1: Introduction -->
        <div class="lesson-section active" id="section1">
            <h2 class="section-title">🌟 What is an Angle?</h2>
            <div class="angle-info">
                <p style="font-size: 1.3rem; text-align: center; margin-bottom: 20px;">
                    An angle is made when two lines meet at a point! Like opening a door or spreading your arms wide.
                </p>
            </div>
            
            <div class="interactive-angle">
                <canvas id="angleCanvas1" class="angle-canvas" width="400" height="300"></canvas>
            </div>
            
            <div class="angle-info">
                <h3>🎯 Remember:</h3>
                <ul style="font-size: 1.2rem; margin-left: 20px; line-height: 1.8;">
                    <li>Two lines that meet = One angle</li>
                    <li>The meeting point is called <strong>vertex</strong></li>
                    <li>The two lines are called <strong>arms</strong></li>
                </ul>
            </div>

            <div class="fun-fact">
                <h4>🤓 Fun Fact!</h4>
                <p>The word "angle" comes from the Greek word "Angilos" which means "curved and not straight"!</p>
            </div>

            <div class="real-world-examples">
                <div class="example-card" onclick="playSound('house')">
                    <div class="example-icon">🏠</div>
                    <h4>Houses</h4>
                    <p>Roof corners make angles!</p>
                </div>
                <div class="example-card" onclick="playSound('bicycle')">
                    <div class="example-icon">🚲</div>
                    <h4>Bicycles</h4>
                    <p>Frame parts join at angles!</p>
                </div>
                <div class="example-card" onclick="playSound('scissors')">
                    <div class="example-icon">✂️</div>
                    <h4>Scissors</h4>
                    <p>Blades open at an angle!</p>
                </div>
                <div class="example-card" onclick="playSound('clock')">
                    <div class="example-icon">🕐</div>
                    <h4>Clock</h4>
                    <p>Clock hands make angles!</p>
                </div>
                <div class="example-card" onclick="playSound('stairs')">
                    <div class="example-icon">🪜</div>
                    <h4>Stairs</h4>
                    <p>Steps make angles with ground!</p>
                </div>
                <div class="example-card" onclick="playSound('tree')">
                    <div class="example-icon">🌳</div>
                    <h4>Tree Branches</h4>
                    <p>Branches spread at angles!</p>
                </div>
            </div>
        </div>

        <!-- Section 2: Types of Angles -->
        <div class="lesson-section" id="section2">
            <h2 class="section-title">🎨 Types of Angles</h2>
            <p style="text-align: center; font-size: 1.3rem; margin-bottom: 30px;">
                Click on each type to learn more!
            </p>
            
            <div class="angle-types">
                <div class="angle-type-card" onclick="selectAngleType('acute')">
                    <h3>Acute Angle</h3>
                    <div class="angle-visual">
                        <canvas width="120" height="100" class="type-canvas" id="acuteCanvas"></canvas>
                    </div>
                    <p><strong>Less than 90°</strong></p>
                    <p>Sharp and pointy! 🔪</p>
                    <p><em>Examples: 30°, 45°, 60°, 75°</em></p>
                </div>
                
                <div class="angle-type-card" onclick="selectAngleType('right')">
                    <h3>Right Angle</h3>
                    <div class="angle-visual">
                        <canvas width="120" height="100" class="type-canvas" id="rightCanvas"></canvas>
                    </div>
                    <p><strong>Exactly 90°</strong></p>
                    <p>Perfect corner! 📐</p>
                    <p><em>Like book corners!</em></p>
                </div>
                
                <div class="angle-type-card" onclick="selectAngleType('obtuse')">
                    <h3>Obtuse Angle</h3>
                    <div class="angle-visual">
                        <canvas width="120" height="100" class="type-canvas" id="obtuseCanvas"></canvas>
                    </div>
                    <p><strong>More than 90°</strong></p>
                    <p>Wide and open! 🌈</p>
                    <p><em>Examples: 120°, 150°, 170°</em></p>
                </div>
                
                <div class="angle-type-card" onclick="selectAngleType('straight')">
                    <h3>Straight Angle</h3>
                    <div class="angle-visual">
                        <canvas width="120" height="100" class="type-canvas" id="straightCanvas"></canvas>
                    </div>
                    <p><strong>Exactly 180°</strong></p>
                    <p>Straight line! ➡️</p>
                    <p><em>Two right angles together!</em></p>
                </div>
            </div>
            
            <div class="angle-info" id="angleDescription">
                <h3>🎯 Click on an angle type above to learn more!</h3>
            </div>
        </div>

        <!-- Section 3: Angle Naming Game -->
        <div class="lesson-section" id="section3">
            <h2 class="section-title">📝 Name That Angle!</h2>
            <div class="naming-game">
                <h3 style="text-align: center; color: #7c3aed; margin-bottom: 20px;">
                    🎯 Drag the labels to name the parts of this angle!
                </h3>
                
                <div class="angle-diagram" id="namingDiagram">
                    <canvas width="300" height="200" id="namingCanvas"></canvas>
                    <div class="drop-zone" id="vertexZone" style="top: 120px; left: 120px;">Vertex</div>
                    <div class="drop-zone" id="arm1Zone" style="top: 80px; left: 200px;">Arm 1</div>
                    <div class="drop-zone" id="arm2Zone" style="top: 160px; left: 200px;">Arm 2</div>
                </div>
                
                <div class="drag-labels">
                    <div class="drag-label" draggable="true" data-label="vertex">B (Vertex)</div>
                    <div class="drag-label" draggable="true" data-label="arm1">BA (Arm)</div>
                    <div class="drag-label" draggable="true" data-label="arm2">BC (Arm)</div>
                    <div class="drag-label" draggable="true" data-label="wrong">XY (Wrong)</div>
                </div>
                
                <div class="angle-info" style="text-align: center;">
                    <p><strong>💡 Remember:</strong> Angles are named with 3 letters - the vertex is always in the middle!</p>
                    <p>This angle can be called <strong>∠ABC</strong> or <strong>∠CBA</strong></p>
                </div>
            </div>
        </div>

        <!-- Section 4: Matching Game -->
        <div class="lesson-section" id="section4">
            <h2 class="section-title">🎮 Angle Matching Game!</h2>
            <div class="matching-game">
                <h3 style="text-align: center; color: #0369a1; margin-bottom: 20px;">
                    🎯 Match the angles with their types! Click pairs to match them.
                </h3>
                
                <div class="matching-pairs" id="matchingPairs">
                    <!-- Matching items will be generated by JavaScript -->
                </div>
                
                <div class="game-score" id="matchingScore">
                    🎯 Matches Found: 0/4 | 🌟 Score: 0 points
                </div>
            </div>
        </div>

        <!-- Section 5: Alphabet Angles -->
        <div class="lesson-section" id="section5">
            <h2 class="section-title">🔤 Find Angles in Letters!</h2>
            <div class="alphabet-game">
                <h3 style="text-align: center; color: #065f46; margin-bottom: 20px;">
                    🎯 Click on letters that have RIGHT ANGLES (90°)!
                </h3>
                
                <div class="alphabet-grid" id="alphabetGrid">
                    <!-- Alphabet cards will be generated by JavaScript -->
                </div>
                
                <div class="game-score" id="alphabetScore">
                    🎯 Right Angles Found: 0 | 🌟 Score: 0 points
                </div>
                
                <div class="angle-info">
                    <p><strong>💡 Hint:</strong> Look for letters with square corners like L, T, F, E, H!</p>
                </div>
            </div>
        </div>

        <!-- Section 6: Interactive Practice -->
        <div class="lesson-section" id="section6">
            <h2 class="section-title">🎮 Create Your Own Angles!</h2>
            <div class="interactive-angle">
                <canvas id="practiceCanvas" class="angle-canvas" width="500" height="400"></canvas>
            </div>
            <div class="angle-info">
                <h3 id="practiceQuestion">Click and drag to create different angles!</h3>
                <p id="practiceResult" style="font-size: 1.3rem; text-align: center; font-weight: bold;"></p>
                <div style="text-align: center; margin-top: 20px;">
                    <button class="nav-btn" onclick="randomAngle()" style="padding: 10px 20px; font-size: 1rem;">
                        🎲 Random Angle
                    </button>
                </div>
            </div>
        </div>

        <!-- Section 7: Quiz -->
        <div class="lesson-section" id="section7">
            <h2 class="section-title">🧠 Ultimate Angle Quiz!</h2>
            <div class="quiz-container">
                <div class="quiz-question" id="quizQuestion">
                    What type of angle is formed by the hands of a clock at 3 o'clock?
                </div>
                <div class="quiz-options" id="quizOptions">
                    <!-- Quiz options will be loaded here -->
                </div>
                <div id="quizFeedback" style="text-align: center; margin-top: 25px; font-size: 1.3rem; font-weight: bold;"></div>
                <div class="game-score" id="quizScore">
                    🎯 Question 1 of 8 | 🌟 Quiz Score: 0 points
                </div>
            </div>
        </div>

        <!-- Section 8: Completion -->
        <div class="lesson-section" id="section8">
            <h2 class="section-title">🎉 Congratulations, Angle Master!</h2>
            <div style="text-align: center; padding: 50px;">
                <div style="font-size: 5rem; margin-bottom: 25px; animation: bounce 2s infinite;">🏆</div>
                <h3 style="color: #4F46E5; margin-bottom: 25px; font-size: 2rem;">You've conquered the world of angles!</h3>
                <div class="game-score" id="finalScore" style="font-size: 1.4rem; margin: 25px 0;">
                    🌟 Total Score: 0 points
                </div>
                <p style="font-size: 1.3rem; margin-bottom: 35px; line-height: 1.6;">
                    🎯 You can now identify acute, right, obtuse, and straight angles<br>
                    📐 You know how to name angles with three letters<br>
                    🎮 You've mastered angle matching and recognition games<br>
                    🔤 You can spot angles in letters and everyday objects!
                </p>
                <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
                    <button class="nav-btn" onclick="restartLesson()">🔄 Play Again</button>
                    <button class="nav-btn" onclick="showCertificate()" style="background: linear-gradient(135deg, #10b981, #059669);">
                        📜 Get Certificate
                    </button>
                </div>
            </div>
        </div>

        <div class="navigation">
            <button class="nav-btn" id="prevBtn" onclick="previousSection()" disabled>← Previous</button>
            <span id="sectionCounter" style="font-size: 1.2rem; font-weight: bold; color: #4F46E5;">1 of 8</span>
            <button class="nav-btn" id="nextBtn" onclick="nextSection()">Next →</button>
        </div>
    </div>

    <div class="celebration" id="celebration">
        <h2 style="color: white; margin-bottom: 20px; font-size: 2rem;">🎉 Fantastic! 🎉</h2>
        <p style="color: white; font-size: 1.3rem;" id="celebrationText">You got it right!</p>
        <div style="font-size: 3rem; margin: 15px 0;">✨🌟✨</div>
    </div>

    <!-- Certificate Modal -->
    <div id="certificateModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2000;">
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 40px; border-radius: 20px; text-align: center; max-width: 500px; border: 5px solid #f59e0b;">
            <h2 style="color: #f59e0b; margin-bottom: 20px;">🏆 Certificate of Achievement 🏆</h2>
            <p style="font-size: 1.2rem; margin-bottom: 15px;">This certifies that</p>
            <h3 style="color: #4F46E5; font-size: 1.8rem; margin-bottom: 15px;">Angle Explorer</h3>
            <p style="margin-bottom: 20px;">has successfully completed the<br><strong>Amazing World of Angles</strong> lesson!</p>
            <div style="margin: 20px 0; font-size: 2rem;">🔺📐🎯✨</div>
            <button class="nav-btn" onclick="closeCertificate()" style="margin-top: 20px;">Close</button>
        </div>
    </div>

    <script>
        // PWA and lesson state management
        let currentSection = 1;
        const totalSections = 8;
        let gameScore = 0;
        let matchingScore = 0;
        let alphabetScore = 0;
        let quizScore = 0;
        let lessonProgress = JSON.parse(localStorage.getItem('anglesLessonProgress')) || {
            currentSection: 1,
            completedSections: [],
            quizAnswers: [],
            gameScore: 0,
            startTime: Date.now()
        };

        // Canvas contexts
        const canvases = {
            intro: document.getElementById('angleCanvas1'),
            practice: document.getElementById('practiceCanvas'),
            acute: document.getElementById('acuteCanvas'),
            right: document.getElementById('rightCanvas'),
            obtuse: document.getElementById('obtuseCanvas'),
            straight: document.getElementById('straightCanvas'),
            naming: document.getElementById('namingCanvas')
        };

        // Quiz questions
        const quizQuestions = [
            {
                question: "What type of angle is formed by the hands of a clock at 3 o'clock?",
                options: ["Acute Angle", "Right Angle", "Obtuse Angle", "Straight Angle"],
                correct: 1,
                explanation: "At 3 o'clock, the clock hands form a perfect 90° angle!"
            },
            {
                question: "Which angle is bigger than 90° but smaller than 180°?",
                options: ["Acute Angle", "Right Angle", "Obtuse Angle", "Straight Angle"],
                correct: 2,
                explanation: "Obtuse angles are always between 90° and 180°!"
            },
            {
                question: "What do we call the point where two lines meet to form an angle?",
                options: ["Arm", "Vertex", "Corner", "Edge"],
                correct: 1,
                explanation: "The vertex is the special point where the two arms of an angle meet!"
            },
            {
                question: "A straight angle measures exactly:",
                options: ["90°", "180°", "270°", "360°"],
                correct: 1,
                explanation: "A straight angle is exactly 180° - like a straight line!"
            },
            {
                question: "Which letter has a right angle in it?",
                options: ["S", "O", "L", "C"],
                correct: 2,
                explanation: "The letter L has a perfect right angle (90°) corner!"
            },
            {
                question: "An acute angle is:",
                options: ["Exactly 90°", "Less than 90°", "More than 90°", "Exactly 180°"],
                correct: 1,
                explanation: "Acute angles are always less than 90° - they're sharp and pointy!"
            },
            {
                question: "How do we name an angle with three letters?",
                options: ["Vertex first", "Vertex in middle", "Vertex last", "Any order"],
                correct: 1,
                explanation: "The vertex always goes in the middle when naming angles with three letters!"
            },
            {
                question: "Which of these shows an obtuse angle?",
                options: ["Clock at 6:00", "Clock at 3:00", "Clock at 2:00", "Clock at 12:00"],
                correct: 2,
                explanation: "At 2:00, the clock hands form an obtuse angle (more than 90°)!"
            }
        ];

        // Matching game data
        const matchingData = [
            { type: 'angle', content: '45°', match: 'acute' },
            { type: 'label', content: 'Acute Angle\n(Sharp & Pointy)', match: 'acute' },
            { type: 'angle', content: '90°', match: 'right' },
            { type: 'label', content: 'Right Angle\n(Perfect Corner)', match: 'right' },
            { type: 'angle', content: '120°', match: 'obtuse' },
            { type: 'label', content: 'Obtuse Angle\n(Wide & Open)', match: 'obtuse' },
            { type: 'angle', content: '180°', match: 'straight' },
            { type: 'label', content: 'Straight Angle\n(Straight Line)', match: 'straight' }
        ];

        // Alphabet with right angles
        const alphabetAngles = {
            hasRightAngles: ['E', 'F', 'H', 'L', 'T', 'I', 'P', 'R', 'B', 'D'],
            noRightAngles: ['A', 'C', 'G', 'J', 'K', 'M', 'N', 'O', 'Q', 'S', 'U', 'V', 'W', 'X', 'Y', 'Z']
        };

        let currentQuiz = 0;
        let quizAnswered = false;
        let matchingItems = [];
        let selectedMatching = [];
        let correctMatches = 0;
        let draggedElement = null;

        // Initialize lesson
        function initLesson() {
            currentSection = lessonProgress.currentSection;
            gameScore = lessonProgress.gameScore || 0;
            updateProgress();
            showSection(currentSection);
            drawAllAngles();
            setupPracticeCanvas();
            initializeGames();
            updateScoreDisplay();
        }

        // Progress management
        function updateProgress() {
            const progress = (currentSection - 1) / (totalSections - 1) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('sectionCounter').textContent = `${currentSection} of ${totalSections}`;
            
            document.getElementById('prevBtn').disabled = currentSection === 1;
            // Don't disable the next button on the last section - it becomes the "Complete!" button
            
            if (currentSection === totalSections) {
                document.getElementById('nextBtn').textContent = 'Complete!';
            } else {
                document.getElementById('nextBtn').textContent = 'Next →';
            }
        }

        function updateScoreDisplay() {
            document.getElementById('gameScore').textContent = `🌟 Score: ${gameScore} points`;
            if (document.getElementById('finalScore')) {
                document.getElementById('finalScore').textContent = `🌟 Total Score: ${gameScore} points`;
            }
        }

        // Section navigation
        function showSection(sectionNum) {
            document.querySelectorAll('.lesson-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById('section' + sectionNum).classList.add('active');
            
            // Special actions for specific sections
            if (sectionNum === 3) {
                setupNamingGame();
            } else if (sectionNum === 4) {
                setupMatchingGame();
            } else if (sectionNum === 5) {
                setupAlphabetGame();
            } else if (sectionNum === 6) {
                setupPracticeCanvas();
            } else if (sectionNum === 7) {
                loadQuiz();
            }
        }

        function nextSection() {
            if (currentSection < totalSections) {
                currentSection++;
                lessonProgress.currentSection = currentSection;
                lessonProgress.completedSections.push(currentSection - 1);
                saveProgress();
                showSection(currentSection);
                updateProgress();
            } else if (currentSection === totalSections) {
                // Redirect to unit1.html when clicking "Complete!"
                window.location.href = '../unit1.html';
            }
        }

        function previousSection() {
            if (currentSection > 1) {
                currentSection--;
                lessonProgress.currentSection = currentSection;
                saveProgress();
                showSection(currentSection);
                updateProgress();
            }
        }

        function restartLesson() {
            currentSection = 1;
            currentQuiz = 0;
            quizAnswered = false;
            gameScore = 0;
            matchingScore = 0;
            alphabetScore = 0;
            quizScore = 0;
            lessonProgress = {
                currentSection: 1,
                completedSections: [],
                quizAnswers: [],
                gameScore: 0,
                startTime: Date.now()
            };
            saveProgress();
            showSection(currentSection);
            updateProgress();
            updateScoreDisplay();
            initializeGames();
        }

        // Save progress to localStorage
        function saveProgress() {
            lessonProgress.gameScore = gameScore;
            localStorage.setItem('anglesLessonProgress', JSON.stringify(lessonProgress));
        }

        // Sound effects (visual feedback since we can't use audio)
        function playSound(type) {
            const card = event.target.closest('.example-card');
            card.style.transform = 'scale(1.2) rotate(5deg)';
            setTimeout(() => {
                card.style.transform = 'scale(1.08) rotate(2deg)';
            }, 200);
            
            addPoints(5);
        }

        function addPoints(points) {
            gameScore += points;
            updateScoreDisplay();
            saveProgress();
            
            // Show point animation
            showPointsAnimation(points);
        }

        function showPointsAnimation(points) {
            const pointsEl = document.createElement('div');
            pointsEl.textContent = `+${points} points!`;
            pointsEl.style.cssText = `
                position: fixed;
                top: 20%;
                left: 50%;
                transform: translateX(-50%);
                background: linear-gradient(135deg, #10b981, #059669);
                color: white;
                padding: 10px 20px;
                border-radius: 25px;
                font-weight: bold;
                font-size: 1.2rem;
                z-index: 1500;
                animation: pointsFloat 2s ease-out forwards;
            `;
            
            document.body.appendChild(pointsEl);
            
            setTimeout(() => {
                document.body.removeChild(pointsEl);
            }, 2000);
        }

        // Add CSS animation for points
        const pointsStyle = document.createElement('style');
        pointsStyle.textContent = `
            @keyframes pointsFloat {
                0% {
                    opacity: 1;
                    transform: translateX(-50%) translateY(0);
                }
                100% {
                    opacity: 0;
                    transform: translateX(-50%) translateY(-50px);
                }
            }
        `;
        document.head.appendChild(pointsStyle);

        // Canvas drawing functions
        function drawAngle(canvas, angle, color = '#4F46E5', showArc = true, showLabel = true) {
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const centerX = canvas.width / 2;
            const centerY = canvas.height - 25;
            const radius = Math.min(canvas.width, canvas.height) * 0.25;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw arms
            ctx.strokeStyle = color;
            ctx.lineWidth = 4;
            ctx.lineCap = 'round';
            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            ctx.lineTo(centerX + radius, centerY);
            ctx.moveTo(centerX, centerY);
            
            if (angle === 180) {
                ctx.lineTo(centerX - radius, centerY);
            } else {
                ctx.lineTo(centerX + radius * Math.cos(angle * Math.PI / 180), 
                           centerY - radius * Math.sin(angle * Math.PI / 180));
            }
            ctx.stroke();
            
            if (showArc && angle > 0 && angle < 180) {
                // Draw arc
                ctx.strokeStyle = '#10b981';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.arc(centerX, centerY, 30, 0, -angle * Math.PI / 180, true);
                ctx.stroke();
            }
            
            if (showLabel) {
                // Draw angle label
                ctx.fillStyle = color;
                ctx.font = 'bold 16px Comic Sans MS';
                ctx.textAlign = 'center';
                ctx.fillText(angle + '°', centerX + 40, centerY - 35);
            }
            
            // Draw vertex point
            ctx.fillStyle = '#ef4444';
            ctx.beginPath();
            ctx.arc(centerX, centerY, 6, 0, 2 * Math.PI);
            ctx.fill();
        }

        function drawAllAngles() {
            drawAngle(canvases.intro, 60, '#4F46E5');
            drawAngle(canvases.acute, 45, '#10b981');
            drawAngle(canvases.right, 90, '#3b82f6');
            drawAngle(canvases.obtuse, 135, '#f59e0b');
            drawAngle(canvases.straight, 180, '#ef4444');
        }

        // Naming game setup
        function setupNamingGame() {
            const canvas = canvases.naming;
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw angle ABC
            ctx.strokeStyle = '#7c3aed';
            ctx.lineWidth = 4;
            ctx.lineCap = 'round';
            
            // Draw arms
            ctx.beginPath();
            ctx.moveTo(120, 120); // B (vertex)
            ctx.lineTo(50, 60);   // A
            ctx.moveTo(120, 120);
            ctx.lineTo(220, 160); // C
            ctx.stroke();
            
            // Draw points
            ctx.fillStyle = '#ef4444';
            ctx.font = 'bold 18px Comic Sans MS';
            ctx.fillText('A', 40, 55);
            ctx.fillText('B', 110, 110);
            ctx.fillText('C', 225, 175);
            
            // Draw vertex point
            ctx.fillStyle = '#ef4444';
            ctx.beginPath();
            ctx.arc(120, 120, 6, 0, 2 * Math.PI);
            ctx.fill();
            
            setupDragDrop();
        }

        function setupDragDrop() {
            const labels = document.querySelectorAll('.drag-label');
            const zones = document.querySelectorAll('.drop-zone');
            
            labels.forEach(label => {
                label.addEventListener('dragstart', (e) => {
                    draggedElement = e.target;
                    e.target.classList.add('dragging');
                });
                
                label.addEventListener('dragend', (e) => {
                    e.target.classList.remove('dragging');
                });
            });
            
            zones.forEach(zone => {
                zone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                });
                
                zone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    if (draggedElement) {
                        const labelType = draggedElement.dataset.label;
                        const zoneId = e.target.id;
                        
                        checkNamingAnswer(labelType, zoneId);
                    }
                });
            });
        }

        function checkNamingAnswer(labelType, zoneId) {
            const correct = 
                (labelType === 'vertex' && zoneId === 'vertexZone') ||
                (labelType === 'arm1' && (zoneId === 'arm1Zone' || zoneId === 'arm2Zone')) ||
                (labelType === 'arm2' && (zoneId === 'arm1Zone' || zoneId === 'arm2Zone'));
            
            if (correct && labelType !== 'wrong') {
                showCelebration('Perfect! You got it right!');
                addPoints(15);
                draggedElement.style.background = 'linear-gradient(135deg, #10b981, #059669)';
                draggedElement.style.color = 'white';
            } else {
                draggedElement.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
                draggedElement.style.color = 'white';
                setTimeout(() => {
                    draggedElement.style.background = 'linear-gradient(135deg, #ddd6fe, #c4b5fd)';
                    draggedElement.style.color = 'black';
                }, 1000);
            }
        }

        // Matching game setup
        function setupMatchingGame() {
            matchingItems = [...matchingData];
            shuffleArray(matchingItems);
            selectedMatching = [];
            correctMatches = 0;
            
            const container = document.getElementById('matchingPairs');
            container.innerHTML = '';
            
            matchingItems.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'match-item';
                div.dataset.match = item.match;
                div.dataset.type = item.type;
                div.onclick = () => selectMatchingItem(div, index);
                
                if (item.type === 'angle') {
                    div.innerHTML = `<div style="font-size: 2rem; font-weight: bold; color: #3b82f6;">${item.content}</div>`;
                } else {
                    div.innerHTML = `<div style="font-size: 1rem; font-weight: bold; color: #059669;">${item.content.replace('\\n', '<br>')}</div>`;
                }
                
                container.appendChild(div);
            });
            
            updateMatchingScore();
        }

        function selectMatchingItem(element, index) {
            if (element.classList.contains('correct')) return;
            
            element.classList.toggle('selected');
            
            if (element.classList.contains('selected')) {
                selectedMatching.push({ element, index });
            } else {
                selectedMatching = selectedMatching.filter(item => item.element !== element);
            }
            
            if (selectedMatching.length === 2) {
                checkMatchingPair();
            }
        }

        function checkMatchingPair() {
            const [item1, item2] = selectedMatching;
            
            if (matchingItems[item1.index].match === matchingItems[item2.index].match) {
                // Correct match
                item1.element.classList.remove('selected');
                item2.element.classList.remove('selected');
                item1.element.classList.add('correct');
                item2.element.classList.add('correct');
                
                correctMatches++;
                addPoints(20);
                showCelebration('Great match!');
                
                if (correctMatches === 4) {
                    setTimeout(() => {
                        showCelebration('Amazing! You matched them all!');
                        addPoints(50);
                    }, 1000);
                }
            } else {
                // Incorrect match
                item1.element.classList.add('incorrect');
                item2.element.classList.add('incorrect');
                
                setTimeout(() => {
                    item1.element.classList.remove('selected', 'incorrect');
                    item2.element.classList.remove('selected', 'incorrect');
                }, 1000);
            }
            
            selectedMatching = [];
            updateMatchingScore();
        }

        function updateMatchingScore() {
            document.getElementById('matchingScore').textContent = 
                `🎯 Matches Found: ${correctMatches}/4 | 🌟 Score: ${Math.floor(matchingScore)} points`;
        }

        // Alphabet game setup
        function setupAlphabetGame() {
            const container = document.getElementById('alphabetGrid');
            container.innerHTML = '';
            
            const allLetters = [...alphabetAngles.hasRightAngles, ...alphabetAngles.noRightAngles];
            shuffleArray(allLetters);
            
            allLetters.slice(0, 16).forEach(letter => {
                const div = document.createElement('div');
                div.className = 'alphabet-card';
                div.textContent = letter;
                div.onclick = () => selectAlphabetLetter(div, letter);
                container.appendChild(div);
            });
            
            updateAlphabetScore();
        }

        function selectAlphabetLetter(element, letter) {
            if (element.classList.contains('correct') || element.classList.contains('incorrect')) return;
            
            if (alphabetAngles.hasRightAngles.includes(letter)) {
                element.classList.add('correct');
                element.style.background = 'linear-gradient(135deg, #10b981, #059669)';
                element.style.color = 'white';
                addPoints(10);
                showCelebration(`Yes! ${letter} has right angles!`);
            } else {
                element.classList.add('incorrect');
                element.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
                element.style.color = 'white';
                setTimeout(() => {
                    element.style.background = 'white';
                    element.style.color = '#065f46';
                    element.classList.remove('incorrect');
                }, 1500);
            }
            
            updateAlphabetScore();
        }

        function updateAlphabetScore() {
            const correctCount = document.querySelectorAll('.alphabet-card.correct').length;
            document.getElementById('alphabetScore').textContent = 
                `🎯 Right Angles Found: ${correctCount} | 🌟 Score: ${alphabetScore} points`;
        }

        // Interactive practice canvas
        function setupPracticeCanvas() {
            const canvas = canvases.practice;
            if (!canvas) return;
            
            let isDragging = false;
            let currentAngle = 45;
            
            function draw(angle) {
                currentAngle = angle;
                drawAngle(canvas, angle, '#4F46E5');
                
                let type = '';
                let description = '';
                let emoji = '';
                
                if (angle < 90) {
                    type = 'Acute Angle';
                    description = 'Sharp and pointy!';
                    emoji = '🔪';
                } else if (angle === 90) {
                    type = 'Right Angle';
                    description = 'Perfect corner!';
                    emoji = '📐';
                } else if (angle < 180) {
                    type = 'Obtuse Angle';
                    description = 'Wide and open!';
                    emoji = '🌈';
                } else {
                    type = 'Straight Angle';
                    description = 'Straight as an arrow!';
                    emoji = '➡️';
                }
                
                document.getElementById('practiceResult').innerHTML = 
                    `<span style="color: #4F46E5;">${type}</span><br>${description} ${emoji}`;
            }
            
            // Mouse and touch events
            canvas.addEventListener('mousedown', () => { isDragging = true; });
            canvas.addEventListener('mousemove', handleMove);
            canvas.addEventListener('mouseup', () => { isDragging = false; });
            canvas.addEventListener('touchstart', (e) => { e.preventDefault(); isDragging = true; });
            canvas.addEventListener('touchmove', handleMove);
            canvas.addEventListener('touchend', (e) => { e.preventDefault(); isDragging = false; });
            
            function handleMove(e) {
                if (isDragging) {
                    const rect = canvas.getBoundingClientRect();
                    const clientX = e.clientX || (e.touches && e.touches[0].clientX);
                    const clientY = e.clientY || (e.touches && e.touches[0].clientY);
                    const x = clientX - rect.left;
                    const y = clientY - rect.top;
                    const centerX = canvas.width / 2;
                    const centerY = canvas.height - 25;
                    
                    const angle = Math.atan2(centerY - y, x - centerX) * 180 / Math.PI;
                    const constrainedAngle = Math.max(0, Math.min(180, angle));
                    draw(constrainedAngle);
                }
            }
            
            draw(45);
        }

        function randomAngle() {
            const angles = [30, 45, 60, 90, 120, 135, 150, 180];
            const randomAngle = angles[Math.floor(Math.random() * angles.length)];
            drawAngle(canvases.practice, randomAngle, '#4F46E5');
            
            let type = '';
            let description = '';
            let emoji = '';
            
            if (randomAngle < 90) {
                type = 'Acute Angle';
                description = 'Sharp and pointy!';
                emoji = '🔪';
            } else if (randomAngle === 90) {
                type = 'Right Angle';
                description = 'Perfect corner!';
                emoji = '📐';
            } else if (randomAngle < 180) {
                type = 'Obtuse Angle';
                description = 'Wide and open!';
                emoji = '🌈';
            } else {
                type = 'Straight Angle';
                description = 'Straight as an arrow!';
                emoji = '➡️';
            }
            
            document.getElementById('practiceResult').innerHTML = 
                `<span style="color: #4F46E5;">${type}</span><br>${description} ${emoji}`;
            
            addPoints(5);
        }

        // Angle type selection
        function selectAngleType(type) {
            document.querySelectorAll('.angle-type-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.target.closest('.angle-type-card').classList.add('selected');
            
            const descriptions = {
                acute: {
                    title: '🔪 Acute Angle',
                    text: 'Acute angles are smaller than 90°. They are sharp and pointy! You can find them in triangular roofs, mountain peaks, and when you partially open scissors. Examples: 30°, 45°, 60°, 75°.'
                },
                right: {
                    title: '📐 Right Angle',
                    text: 'Right angles are exactly 90°. They make perfect corners! You see them in book corners, door frames, and the letter "L". They are super important in construction and are used in set squares!'
                },
                obtuse: {
                    title: '🌈 Obtuse Angle',
                    text: 'Obtuse angles are bigger than 90° but smaller than 180°. They are wide and open! You can see them when you open a book wide or spread your arms. Examples: 120°, 150°, 170°.'
                },
                straight: {
                    title: '➡️ Straight Angle',
                    text: 'Straight angles are exactly 180°. They form a straight line! It\'s like when you stretch your arms out to both sides or draw a straight line on paper. A straight angle is made by combining two consecutive right angles!'
                }
            };
            
            const desc = descriptions[type];
            document.getElementById('angleDescription').innerHTML = 
                `<h3>${desc.title}</h3><p style="font-size: 1.1rem;">${desc.text}</p>`;
            
            addPoints(5);
        }

        // Quiz functionality
        function loadQuiz() {
            if (currentQuiz < quizQuestions.length) {
                const quiz = quizQuestions[currentQuiz];
                document.getElementById('quizQuestion').textContent = quiz.question;
                
                const optionsContainer = document.getElementById('quizOptions');
                optionsContainer.innerHTML = '';
                
                quiz.options.forEach((option, index) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'quiz-option';
                    optionDiv.textContent = option;
                    optionDiv.onclick = () => selectAnswer(optionDiv, index === quiz.correct);
                    optionsContainer.appendChild(optionDiv);
                });
                
                document.getElementById('quizFeedback').innerHTML = '';
                document.getElementById('quizScore').textContent = 
                    `🎯 Question ${currentQuiz + 1} of ${quizQuestions.length} | 🌟 Quiz Score: ${quizScore} points`;
                quizAnswered = false;
            }
        }

        function selectAnswer(element, isCorrect) {
            if (quizAnswered) return;
            
            quizAnswered = true;
            const quiz = quizQuestions[currentQuiz];
            
            document.querySelectorAll('.quiz-option').forEach((option, index) => {
                if (index === quiz.correct) {
                    option.classList.add('correct');
                } else if (option === element && !isCorrect) {
                    option.classList.add('incorrect');
                }
            });
            
            if (isCorrect) {
                document.getElementById('quizFeedback').innerHTML = 
                    `<span style="color: #10b981;">✅ Correct! ${quiz.explanation}</span>`;
                showCelebration('Excellent answer!');
                addPoints(25);
                quizScore += 25;
                lessonProgress.quizAnswers.push(true);
            } else {
                document.getElementById('quizFeedback').innerHTML = 
                    `<span style="color: #ef4444;">❌ Not quite right. ${quiz.explanation}</span>`;
                lessonProgress.quizAnswers.push(false);
            }
            
            document.getElementById('quizScore').textContent = 
                `🎯 Question ${currentQuiz + 1} of ${quizQuestions.length} | 🌟 Quiz Score: ${quizScore} points`;
            
            saveProgress();
            
            // Auto advance to next quiz after 3 seconds
            setTimeout(() => {
                currentQuiz++;
                if (currentQuiz < quizQuestions.length) {
                    loadQuiz();
                } else {
                    // All quizzes completed
                    document.getElementById('quizQuestion').innerHTML = 
                        "🎉 Quiz Complete! You're an angle expert!";
                    document.getElementById('quizOptions').innerHTML = '';
                    document.getElementById('quizFeedback').innerHTML = 
                        '<span style="color: #4F46E5;">🏆 Fantastic job completing all the questions!</span>';
                    
                    const correctAnswers = lessonProgress.quizAnswers.filter(answer => answer).length;
                    const bonusPoints = correctAnswers * 10;
                    addPoints(bonusPoints);
                    
                    setTimeout(() => {
                        showCelebration(`Bonus: +${bonusPoints} points for completing the quiz!`);
                    }, 1000);
                }
            }, 3000);
        }

        function showCelebration(message = 'You got it right!') {
            const celebration = document.getElementById('celebration');
            document.getElementById('celebrationText').textContent = message;
            celebration.classList.add('show');
            setTimeout(() => {
                celebration.classList.remove('show');
            }, 2500);
        }

        // Certificate functionality
        function showCertificate() {
            document.getElementById('certificateModal').style.display = 'block';
            addPoints(100);
        }

        function closeCertificate() {
            document.getElementById('certificateModal').style.display = 'none';
        }

        // Utility functions
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function initializeGames() {
            // Reset all game states
            matchingItems = [];
            selectedMatching = [];
            correctMatches = 0;
            currentQuiz = 0;
            quizAnswered = false;
            quizScore = 0;
            matchingScore = 0;
            alphabetScore = 0;
        }

        // Initialize lesson when page loads
        window.addEventListener('load', function() {
            initLesson();
        });

        // Template functionality
        document.addEventListener('DOMContentLoaded', function() {
            const menuToggle = document.getElementById('menuToggle');
            const sidebar = document.getElementById('sidebar');
            const closeSidebar = document.getElementById('closeSidebar');

            // Menu toggle functionality
            if (menuToggle) {
                menuToggle.addEventListener('click', function() {
                    sidebar.classList.toggle('active');
                });
            }

            // Close sidebar functionality
            if (closeSidebar) {
                closeSidebar.addEventListener('click', function() {
                    sidebar.classList.remove('active');
                });
            }

            // Close sidebar when clicking outside
            document.addEventListener('click', function(event) {
                if (!sidebar.contains(event.target) && !menuToggle.contains(event.target)) {
                    sidebar.classList.remove('active');
                }
            });
        });

        // Add keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft' && currentSection > 1) {
                previousSection();
            } else if (e.key === 'ArrowRight' && currentSection < totalSections) {
                nextSection();
            } else if (e.key === 'r' || e.key === 'R') {
                if (currentSection === 6) {
                    randomAngle();
                }
            }
        });

        // Handle orientation changes for mobile devices
        window.addEventListener('orientationchange', function() {
            setTimeout(() => {
                drawAllAngles();
                if (currentSection === 3) {
                    setupNamingGame();
                } else if (currentSection === 6) {
                    setupPracticeCanvas();
                }
            }, 200);
        });

        // Prevent zoom on double tap for better mobile experience
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function (event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // Add some fun easter eggs
        let clickCount = 0;
        document.querySelector('.header h1').addEventListener('click', function() {
            clickCount++;
            if (clickCount === 5) {
                showCelebration('🎉 You found the secret! Bonus points!');
                addPoints(50);
                clickCount = 0;
            }
        });

        // Add accessibility improvements
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' || e.key === ' ') {
                const focusedElement = document.activeElement;
                if (focusedElement.classList.contains('quiz-option') || 
                    focusedElement.classList.contains('match-item') ||
                    focusedElement.classList.contains('alphabet-card')) {
                    focusedElement.click();
                    e.preventDefault();
                }
            }
        });

        // Make interactive elements focusable
        function makeFocusable() {
            const interactiveElements = document.querySelectorAll('.quiz-option, .match-item, .alphabet-card, .example-card, .angle-type-card');
            interactiveElements.forEach(el => {
                if (!el.tabIndex) el.tabIndex = 0;
            });
        }

        // Update focusable elements when sections change
        const originalShowSection = showSection;
        showSection = function(sectionNum) {
            originalShowSection(sectionNum);
            setTimeout(makeFocusable, 100);
        };

        // PWA Service Worker (if needed)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js').then(function(registration) {
                    console.log('ServiceWorker registration successful');
                }).catch(function(err) {
                    console.log('ServiceWorker registration failed: ', err);
                });
            });
        }
    </script>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <p data-translate="loading">Loading...</p>
    </div>

    <!-- Template Scripts -->
    <script src="../../../../assets/js/app.js"></script>
    <script src="../../../../assets/js/navigation.js"></script>
    <script src="../../../../assets/js/language.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(registration => {
                        console.log('SW registered: ', registration);
                    })
                    .catch(registrationError => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>

    <!-- Language and Navigation Fix -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Apply initial language
            const savedLang = localStorage.getItem('preferredLanguage') || 'en';
            applyBasicTranslations(savedLang);
            
            // Set active language button
            const activeBtn = document.querySelector(`[data-lang="${savedLang}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            // Language switcher functionality
            const langButtons = document.querySelectorAll('.lang-btn');
            
            langButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const lang = this.getAttribute('data-lang');
                    
                    // Remove active class from all buttons
                    langButtons.forEach(b => b.classList.remove('active'));
                    
                    // Add active class to clicked button
                    this.classList.add('active');
                    
                    // Store language preference
                    localStorage.setItem('preferredLanguage', lang);
                    
                    // Apply translations if LanguageManager is available
                    if (window.LanguageManager && window.LanguageManager.switchLanguage) {
                        window.LanguageManager.switchLanguage(lang);
                    } else {
                        console.log('LanguageManager not available, applying basic translations');
                        applyBasicTranslations(lang);
                    }
                });
            });
        });

        function applyBasicTranslations(lang) {
            const translations = {
                en: {
                    'messages.schoolName': 'Primary School Learning App',
                    'navigation': 'Navigation',
                    'home': 'Home',
                    'allStandards': 'All Standards',
                    'settings': 'Settings',
                    'about': 'About',
                    'loading': 'Loading...',
                    'standards.standard1': '1st STD',
                    'standards.standard2': '2nd STD',
                    'standards.standard3': '3rd STD',
                    'standards.standard4': '4th STD',
                    'standards.standard5': '5th STD',
                    'standards.standard6': '6th STD'
                },
                ta: {
                    'messages.schoolName': 'ஆரம்ப பள்ளி கற்றல் பயன்பாடு',
                    'navigation': 'வழிகாட்டுதல்',
                    'home': 'முகப்பு',
                    'allStandards': 'அனைத்து தரங்களும்',
                    'settings': 'அமைப்புகள்',
                    'about': 'பற்றி',
                    'loading': 'ஏற்றுகிறது...',
                    'standards.standard1': '1 ஆம் வகுப்பு',
                    'standards.standard2': '2 ஆம் வகுப்பு',
                    'standards.standard3': '3 ஆம் வகுப்பு',
                    'standards.standard4': '4 ஆம் வகுப்பு',
                    'standards.standard5': '5 ஆம் வகுப்பு',
                    'standards.standard6': '6 ஆம் வகுப்பு'
                },
                ur: {
                    'messages.schoolName': 'پرائمری اسکول لرننگ ایپ',
                    'navigation': 'نیویگیشن',
                    'home': 'ہوم',
                    'allStandards': 'تمام معیارات',
                    'settings': 'ترتیبات',
                    'about': 'کے بارے میں',
                    'loading': 'لوڈ ہو رہا ہے...',
                    'standards.standard1': 'پہلی',
                    'standards.standard2': 'دوسری',
                    'standards.standard3': 'تیسری',
                    'standards.standard4': 'چوتھی',
                    'standards.standard5': 'پانچویں',
                    'standards.standard6': 'چھٹی'
                }
            };

            const langData = translations[lang] || translations.en;
            
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                if (langData[key]) {
                    element.textContent = langData[key];
                }
            });
        }
    </script>
</body>
</html>
                